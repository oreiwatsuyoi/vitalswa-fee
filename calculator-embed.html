<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VitalSwap Fee Calculator</title>
<style>
body {
  margin: 0;
  padding: 20px;
  font-family: 'Inter', sans-serif;
  background: #f8fafc;
}
.calculator-embed {
  max-width: 800px;
  margin: 0 auto;
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(20px);
  border: 1px solid rgba(37, 99, 235, 0.15);
  border-radius: 30px;
  padding: 3rem;
  text-align: center;
  box-shadow: 0 12px 40px rgba(37, 99, 235, 0.15);
}
</style>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
</head>
<body>
<div class="calculator-embed">
  <!-- Copy the exact calculator section from your main page -->
  <h2>VitalSwap Fee Calculator</h2>
  <p>Calculate fees for any VitalSwap service</p>
  
  <form role="form" aria-label="Fee calculation form">
    <fieldset style="border: none; padding: 0; margin: 0;">
      <legend class="sr-only">Account and Service Selection</legend>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
        <select id="accountType" style="width: 100%; padding: 1rem 1.5rem; background: rgba(255, 255, 255, 0.95); border: 2px solid rgba(37, 99, 235, 0.2); border-radius: 15px; color: #000; font-size: 1rem;">
          <option value="Customer">Customer Account</option>
          <option value="Business">Business Account</option>
        </select>
        <select id="serviceType" style="width: 100%; padding: 1rem 1.5rem; background: rgba(255, 255, 255, 0.95); border: 2px solid rgba(37, 99, 235, 0.2); border-radius: 15px; color: #000; font-size: 1rem;">
          <option value="">Select Service</option>
        </select>
      </div>
    </fieldset>
    
    <select id="specificService" style="width: 100%; padding: 1rem 1.5rem; background: rgba(255, 255, 255, 0.95); border: 2px solid rgba(37, 99, 235, 0.2); border-radius: 15px; color: #000; font-size: 1rem; margin-bottom: 1.5rem;">
      <option value="">Select Specific Fee</option>
    </select>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
      <input type="number" id="tradeAmount" placeholder="Enter amount" min="0" step="0.01" style="width: 100%; padding: 1rem 1.5rem; background: rgba(255, 255, 255, 0.95); border: 2px solid rgba(37, 99, 235, 0.2); border-radius: 15px; color: #000; font-size: 1rem;">
      <select id="currency" style="width: 100%; padding: 1rem 1.5rem; background: rgba(255, 255, 255, 0.95); border: 2px solid rgba(37, 99, 235, 0.2); border-radius: 15px; color: #000; font-size: 1rem;">
        <option value="USD">USD ($)</option>
        <option value="NGN">NGN (₦)</option>
      </select>
    </div>
  </form>
  
  <div id="feeResult" style="background: linear-gradient(135deg, #2563eb, #3b82f6); padding: 2rem; border-radius: 20px; margin-top: 2rem; font-size: 1.5rem; font-weight: 700; color: white; min-height: 80px; display: flex; align-items: center; justify-content: center;">
    Enter amount to see fees
  </div>
  
  <div style="margin-top: 2rem; display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; text-align: center;">
    <div style="background: rgba(255, 255, 255, 0.1); padding: 1rem; border-radius: 10px;">
      <div style="font-size: 0.9rem; color: #64748b;">Fee Amount</div>
      <div id="networkFee" style="font-weight: 700; color: #059669;">$0.00</div>
    </div>
    <div style="background: rgba(255, 255, 255, 0.1); padding: 1rem; border-radius: 10px;">
      <div style="font-size: 0.9rem; color: #64748b;">Service</div>
      <div id="platformFee" style="font-weight: 700; color: #3b82f6; font-size: 0.8rem;">Select Service</div>
    </div>
    <div style="background: rgba(255, 255, 255, 0.1); padding: 1rem; border-radius: 10px;">
      <div style="font-size: 0.9rem; color: #64748b;">You Pay</div>
      <div id="totalFee" style="font-weight: 700; color: #1d4ed8;">$0.00</div>
    </div>
  </div>
</div>

<script>
// Copy the exact calculator JavaScript from your main page
let feeData = {};
let exchangeRates = {};

async function fetchFeeData() {
  try {
    const response = await fetch('https://2kbbumlxz3.execute-api.us-east-1.amazonaws.com/default/fee');
    const data = await response.json();
    return data;
  } catch (error) {
    return {
      "Customer": {
        "US Virtual Bank Account": [
          { "Service": "Individual Account Issue", "Fee": "FREE" },
          { "Service": "Wire Deposit Fee", "Fee": "$15" }
        ],
        "Freedom Virtual Card": [
          { "Service": "Create Card", "Fee": "$1" },
          { "Service": "Fund Card", "Fee": "$0.50" }
        ]
      },
      "Business": {
        "US Virtual Bank Account": [
          { "Service": "Business Account Issue", "Fee": "FREE" },
          { "Service": "Wire Deposit Fee", "Fee": "$15" }
        ]
      }
    };
  }
}

async function fetchExchangeRate() {
  try {
    const response = await fetch('https://2kbbumlxz3.execute-api.us-east-1.amazonaws.com/default/exchange?from=NGN&to=USD');
    const data = await response.json();
    return data;
  } catch (error) {
    return { 'USD': { rate: 1, symbol: '$' }, 'NGN': { rate: 1600, symbol: '₦' } };
  }
}

function setupCalculator() {
  const accountTypeSelect = document.getElementById('accountType');
  const serviceTypeSelect = document.getElementById('serviceType');
  const specificServiceSelect = document.getElementById('specificService');
  const amountInput = document.getElementById('tradeAmount');
  const currencySelect = document.getElementById('currency');
  const feeResult = document.getElementById('feeResult');
  const networkFeeEl = document.getElementById('networkFee');
  const platformFeeEl = document.getElementById('platformFee');
  const totalFeeEl = document.getElementById('totalFee');
  
  function populateServiceTypes() {
    const accountType = accountTypeSelect.value;
    const services = Object.keys(feeData[accountType] || {});
    
    serviceTypeSelect.innerHTML = '<option value="">Select Service</option>';
    services.forEach(service => {
      const option = document.createElement('option');
      option.value = service;
      option.textContent = service;
      serviceTypeSelect.appendChild(option);
    });
    
    specificServiceSelect.innerHTML = '<option value="">Select Specific Fee</option>';
  }
  
  function populateSpecificServices() {
    const accountType = accountTypeSelect.value;
    const serviceType = serviceTypeSelect.value;
    
    if (!serviceType) {
      specificServiceSelect.innerHTML = '<option value="">Select Specific Fee</option>';
      return;
    }
    
    const specificServices = feeData[accountType][serviceType] || [];
    specificServiceSelect.innerHTML = '<option value="">Select Specific Fee</option>';
    
    specificServices.forEach((service, index) => {
      const option = document.createElement('option');
      option.value = index;
      option.textContent = service.Service;
      specificServiceSelect.appendChild(option);
    });
  }
  
  function calculateFee() {
    const accountType = accountTypeSelect.value;
    const serviceType = serviceTypeSelect.value;
    const specificIndex = specificServiceSelect.value;
    const amount = parseFloat(amountInput.value) || 0;
    const selectedCurrency = currencySelect.value;
    const currencySymbol = selectedCurrency === 'USD' ? '$' : '₦';
    
    if (!serviceType || specificIndex === '' || amount <= 0) {
      feeResult.innerHTML = '<span>Please fill all fields</span>';
      networkFeeEl.textContent = currencySymbol + '0.00';
      platformFeeEl.textContent = 'Select Service';
      totalFeeEl.textContent = currencySymbol + '0.00';
      return;
    }
    
    const service = feeData[accountType][serviceType][specificIndex];
    const feeStr = service.Fee;
    
    let calculatedFee = 0;
    let feeDisplay = feeStr;
    
    if (feeStr === 'FREE') {
      calculatedFee = 0;
      feeDisplay = 'FREE';
    } else if (feeStr.includes('%')) {
      const percentMatch = feeStr.match(/([\\d.]+)%/);
      if (percentMatch) {
        const percentage = parseFloat(percentMatch[1]) / 100;
        calculatedFee = amount * percentage;
        feeDisplay = `${percentMatch[1]}% = ${currencySymbol}${calculatedFee.toFixed(2)}`;
      }
    } else {
      const dollarMatch = feeStr.match(/\\$([\\d.]+)/);
      if (dollarMatch) {
        const feeInUSD = parseFloat(dollarMatch[1]);
        calculatedFee = selectedCurrency === 'USD' ? feeInUSD : feeInUSD * 1600;
        feeDisplay = selectedCurrency === 'USD' ? `$${feeInUSD}` : `$${feeInUSD} = ${currencySymbol}${calculatedFee.toFixed(2)}`;
      }
    }
    
    const total = amount + calculatedFee;
    
    feeResult.innerHTML = `
      <div style="display: flex; align-items: center; gap: 1rem; justify-content: center;">
        <span>${service.Service}: ${feeDisplay}</span>
      </div>
    `;
    
    networkFeeEl.textContent = feeStr === 'FREE' ? 'FREE' : `${currencySymbol}${calculatedFee.toFixed(2)}`;
    platformFeeEl.textContent = service.Service;
    totalFeeEl.textContent = `${currencySymbol}${total.toFixed(2)}`;
  }
  
  accountTypeSelect.addEventListener('change', populateServiceTypes);
  serviceTypeSelect.addEventListener('change', populateSpecificServices);
  specificServiceSelect.addEventListener('change', calculateFee);
  amountInput.addEventListener('input', calculateFee);
  currencySelect.addEventListener('change', calculateFee);
  
  populateServiceTypes();
}

document.addEventListener('DOMContentLoaded', async () => {
  feeData = await fetchFeeData();
  exchangeRates = await fetchExchangeRate();
  setupCalculator();
});
</script>
</body>
</html>